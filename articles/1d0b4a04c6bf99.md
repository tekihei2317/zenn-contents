---
title: "TypeScriptで業務アプリを試作してみた（tRPC+Prisma+Next.js）"
emoji: "🦔"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["typescript", "prisma", "trpc"]
published: false
---

TypeScriptで業務アプリケーションを試作してみたので、作っているときに考えたことについて書こうと思います。

なぜTypeScriptで業務アプリケーションを作ってみたかというと、Domain Modeling Made Functionalという本を読んだことがきっかけです。Domain Modeling Made Functional（以降DMMF）は、F#で現実のモデルに基づいた堅牢なアプリケーションを作る方法について書かれた本です。

本の内容が素晴らしかったので、TypeScriptで実践するにはどうすればいいのかが気になりました。また、DMMFではデータベースとのやりとりがモックで実装されていたり、1つのワークフロー（商品の注文）しか扱っていません。そのため、本格的なケースで試してみようと思いました。

## 作ったもの

花束問題というデータモデリングの問題に基づいた、在庫管理アプリケーションを作りました。

花束問題は、次のような問題です。

ソースコードとアプリケーションはこちらにあります。現在はユーザー登録ができないため、動作確認してみたい場合はクローンして確認していただければと思います。

次のフレームワークやライブラリを使って開発しました。

- Next.js
- Mantine
- tRPC
- Prisma

## 実装する前に考えること

### まずは問題を正しく理解する

DMMFにも書かれていることですが、ソフトウェア開発者の仕事はコードを書くことではなく、問題を解決することです。問題を解決するためには、問題を正しく理解する必要があります。問題を正しく理解するためには、例えば次のことが重要です。

- 問題に詳しい人（ドメインエキスパート）と対話する
- 実際の現場で何が行われているかを観察する

もし花束問題が現実の問題だとすると、実際に花屋さんに行ってお店の人と話をしてみたり、花屋さんがどのように仕入れをしているのか、在庫を管理しているのかを観察してみるのがよいのかなと思います。

### システムの全体像を図に書き起こす

DMMFではイベントストーミングというワークショップが紹介されています。イベントストーミングは、業務の全体像や手順を把握したり、プロジェクトに関わる人たちの間で共通理解を作るためのワークショップです。

イベントストーミングは複数人で行うワークショップですが、成果物はシステムの全体像を把握するために役に立つためやってみました。その結果、このシステムは5つのコンテキストに分けるとよさそうだということが分かりました。

### 業務の手順を自然言語で記述する

## データベースの設計

### データベースはアプリケーションの心臓

### 業務の手順と画面設計があると、データベースの設計がやりやすい

### テーブルの設計で重要なポイント

### テーブルの具体的な設計例

## 実装について

### 実装がシンプルにまとまる見込みがある場合は、素直に書き下す

### 書き下すと大きくなる場合は、データの型を定義して関数に分割する

### 複雑になってきた場合は3つのレイヤーに分ける

## これから試すこと

## 振り返り

## まとめ
