---
title: "GitHub Actionsã‚’å­¦ã‚“ã ã®ã§åŸºæœ¬çš„ãªæ¦‚å¿µã‚’æ•´ç†ã—ã¦ã¿ã‚‹"
emoji: "ğŸ™"
type: "tech"
topics: ["githubactions"]
published: true
---

## GitHub Actionsã®æ¦‚è¦

GitHub Actionsã¯ã€ãƒ†ã‚¹ãƒˆãƒ»ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ‡ãƒ—ãƒ­ã‚¤ãªã©ã‚’è‡ªå‹•åŒ–ã™ã‚‹ãŸã‚ã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚GitHub Actionsã®å®Ÿè¡Œç’°å¢ƒï¼ˆãƒ©ãƒ³ãƒŠãƒ¼ï¼‰ã¯Linuxãƒ»Windowsãƒ»MacOSã‹ã‚‰é¸æŠã§ãã¾ã™ã€‚

## GitHub Actionsã®ç”¨èª

| ç”¨èª     | æ„å‘³                                                                               |
| -------- | ---------------------------------------------------------------------------------- |
| workflow | ã‚¤ãƒ™ãƒ³ãƒˆãŒèµ·ããŸã¨ãã«å®Ÿè¡Œã™ã‚‹ä¸€é€£ã®å‡¦ç†ã€‚                                         |
| event    | ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ãƒˆãƒªã‚¬ãƒ¼ã™ã‚‹ã€GitHubä¸Šã§èµ·ãã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã€‚                             |
| job      | ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’æ§‹æˆã™ã‚‹å‡¦ç†ã®ã¾ã¨ã¾ã‚Šã€‚ä¸¦åˆ—ã¾ãŸã¯ç›´åˆ—ã«å®Ÿè¡Œå¯èƒ½ã€‚                   |
| step     | ã‚¸ãƒ§ãƒ–ã‚’æ§‹æˆã™ã‚‹1ã¤ã®1ã¤ã®å‡¦ç†ã€‚ã‚·ã‚§ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¾ãŸã¯å†åˆ©ç”¨å¯èƒ½ãªactionã‚’ä½¿ãˆã‚‹ã€‚ |
| runner   | ã‚¸ãƒ§ãƒ–ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã‚µãƒ¼ãƒãƒ¼ã€‚                                                 |

å›³ã§æ•´ç†ã™ã‚‹ã¨ä»¥ä¸‹ã®ã‚ˆã†ãªæ„Ÿã˜ã§ã™ã€‚

```mermaid
classDiagram
  workflow <-- event :ãƒˆãƒªã‚¬ãƒ¼
  workflow o-- job :has-a
  job o-- step :has-a
  step <|-- shell_script :is-a
  step <|-- action :is-a
  
```

## ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆã™ã‚‹ã¨ãã«è€ƒæ…®ã™ã‚‹æ€§è³ª

ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½œæˆã™ã‚‹ä¸Šã§è€ƒæ…®ã™ã‚‹ã®ã¯ã€ã‚¸ãƒ§ãƒ–ã®ä»¥ä¸‹ã®æ€§è³ªã§ã™ã€‚

1. ã‚¸ãƒ§ãƒ–ã«ã¯ä¾å­˜é–¢ä¿‚ãŒå®šç¾©ã§ãã€ä¾å­˜é–¢ä¿‚ã«ã‚ˆã£ã¦å®Ÿè¡Œé †åºãŒæ±ºã¾ã‚‹ã€‚ä¾å­˜é–¢ä¿‚ã‚’å®šç¾©ã—ãªã„å ´åˆã¯ä¸¦åˆ—ã«å®Ÿè¡Œã•ã‚Œã‚‹ã€‚
2. ç•°ãªã‚‹ã‚¸ãƒ§ãƒ–ã¯ç•°ãªã‚‹ãƒ©ãƒ³ãƒŠãƒ¼ï¼ˆã‚µãƒ¼ãƒãƒ¼ï¼‰ã§å®Ÿè¡Œã•ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã—ãŸã„å ´åˆã¯GitHubã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ã™ã‚‹ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ã†å¿…è¦ãŒã‚ã‚‹ã€‚

### ã‚¸ãƒ§ãƒ–ã«ã¯ä¾å­˜é–¢ä¿‚ãŒå®šç¾©ã§ãã‚‹

ã‚ã‚‹ã‚¸ãƒ§ãƒ–ã¯ã€ãã®ã‚¸ãƒ§ãƒ–ãŒä¾å­˜ã—ã¦ã„ã‚‹ã™ã¹ã¦ã®ã‚¸ãƒ§ãƒ–ãŒæ­£å¸¸ã«çµ‚äº†ã—ãŸã‚ã¨ã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

ä¾‹ãˆã°ã€ã‚¸ãƒ§ãƒ–1â†ã‚¸ãƒ§ãƒ–2ã€ã‚¸ãƒ§ãƒ–1â†ã‚¸ãƒ§ãƒ–3ã®ã‚ˆã†ã«ä¾å­˜é–¢ä¿‚ã‚’å®šç¾©ã—ãŸå ´åˆã€ä»¥ä¸‹ã®ç”»åƒã®å·¦ã‹ã‚‰å³ã®é †ã«å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚

![https://i.gyazo.com/adb2d975f0332329a54b5a9b34de16d3.png](https://i.gyazo.com/adb2d975f0332329a54b5a9b34de16d3.png)

ã‚¸ãƒ§ãƒ–ã«ä¾å­˜é–¢ä¿‚ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã«ã¯ã€`jobs.<job_id>.needs`ã‚’ä½¿ã„ã¾ã™ã€‚

```yaml
name: learn-job-dependency
on: [push]
jobs:
  job1:
    runs-on: ubuntu-20.04
    steps:
      - run: echo 'Hello, job1'
  job2:
    runs-on: ubuntu-20.04
    needs: job1
    steps:
      - run: echo 'Hello, job2'
  job3:
    runs-on: ubuntu-20.04
    needs: job1
    steps:
      - run: echo 'Hello, job3'
```

### ç•°ãªã‚‹ã‚¸ãƒ§ãƒ–ã¯ç•°ãªã‚‹ãƒ©ãƒ³ãƒŠãƒ¼ã§å®Ÿè¡Œã•ã‚Œã‚‹

ç•°ãªã‚‹ã‚¸ãƒ§ãƒ–ã¯ç•°ãªã‚‹ãƒ©ãƒ³ãƒŠãƒ¼ã§å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ã€ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã™ã‚‹ãŸã‚ã«ã¯å·¥å¤«ãŒå¿…è¦ã«ãªã‚Šã¾ã™ã€‚

ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã™ã‚‹1ã¤ã®æ–¹æ³•ã¯ã€artifactsï¼ˆæˆæœç‰©ï¼‰ã‚’ä½¿ã†æ–¹æ³•ã§ã™ã€‚artifactsã¨ã¯GitHub Actionsã§GitHubã«ä¿å­˜ã§ãã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ç¾¤ã®ã“ã¨ã§ã™ã€‚artifactsã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯90æ—¥é–“ä¿å­˜ã•ã‚Œã¾ã™ã€‚

ã¾ãšã€å…±æœ‰ãŒä¸Šæ‰‹ãã„ã‹ãªã„ä¾‹ã‚’ä»¥ä¸‹ã«ç¤ºã—ã¾ã™ã€‚ä¾å­˜é–¢ä¿‚ã‚’å®šç¾©ã—ã¦é †ç•ªã«å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ã—ã¦ã„ã‚‹ã‚‚ã®ã®ã€å®Ÿè¡Œã•ã‚Œã‚‹ãƒ©ãƒ³ãƒŠãƒ¼ãŒåˆ¥ã®ãŸã‚ã€å‰ã®ã‚¸ãƒ§ãƒ–ã§ä½œæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã«ã¯ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“ã€‚

```yaml
name: learn-sharing-data-between-jobs
on: [push]
jobs:
  output:
    runs-on: ubuntu-20.04
    steps:
      - run: expr 1 + 1 > output.log
      - run: ls -l
  use-output:
    runs-on: ubuntu-20.04
    needs: output
    steps:
      - run: ls -l # ãƒ•ã‚¡ã‚¤ãƒ«ã¯å­˜åœ¨ã—ãªã„
```

![https://i.gyazo.com/3976efbe842f6ec5da13121bb0155024.png](https://i.gyazo.com/3976efbe842f6ec5da13121bb0155024.png)

æ¬¡ã«ã€artifactã‚’ä½¿ã£ãŸæ­£ã—ã„æ–¹æ³•ã§ã™ã€‚

```yaml
name: learn-sharing-data-between-jobs
on: [push]
jobs:
  upload-file:
    runs-on: ubuntu-20.04
    steps:
      - run: expr 1 + 1 > output.log
      - uses: actions/upload-artifact@v3
        with:
          name: output-log
          path: output.log
  download-file:
    runs-on: ubuntu-20.04
    needs: upload-file
    steps:
      - uses: actions/download-artifact@v3
        with:
          name: output-log
      - run: cat output.log
```

![https://i.gyazo.com/f3d2d0dacf29d720d10578840d8cdcfb.png](https://i.gyazo.com/f3d2d0dacf29d720d10578840d8cdcfb.png)

GitHubã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ã„ã‚‹ãŸã‚å…±æœ‰ã§ãã¦ã„ã¾ã™ã€‚ã‚¸ãƒ§ãƒ–é–“ã§ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã™ã‚‹ä»–ã®æ–¹æ³•ã«ã¯ã€`set-output`ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ã†æ–¹æ³•ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚

[GitHub Actionsã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚³ãƒãƒ³ãƒ‰ - GitHub Docs](https://docs.github.com/ja/actions/using-workflows/workflow-commands-for-github-actions)

## å‚è€ƒ

- [Understanding GitHub Actions - GitHub Docs](https://docs.github.com/ja/actions/learn-github-actions/understanding-github-actions)
    - GitHub Actionsã®æ¦‚è¦ã€ç”¨èªã®å®šç¾©
- [Using jobs in a workflow - GitHub Docs](https://docs.github.com/ja/actions/using-jobs/using-jobs-in-a-workflow)
    - ã‚¸ãƒ§ãƒ–ã®ä¾å­˜é–¢ä¿‚ã«ã¤ã„ã¦
- [GitHub Actions ã®é‡è¦ãªæ©Ÿèƒ½ - GitHub Docs](https://docs.github.com/ja/actions/learn-github-actions/essential-features-of-github-actions#sharing-data-between-jobs)
    - ã‚¸ãƒ§ãƒ–é–“ã®ãƒ‡ãƒ¼ã‚¿ã®å…±æœ‰ã«ã¤ã„ã¦