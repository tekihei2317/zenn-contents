---
title: "ã€å°ãƒã‚¿ã€‘tRPCã®APIã‚’Postmanã§å®Ÿè¡Œã™ã‚‹æ–¹æ³•"
emoji: "ğŸ˜½"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["trpc", "postman", "å°ãƒã‚¿"]
published: true
---

tRPCã¯HTTPãƒ™ãƒ¼ã‚¹ã®RPCãªã®ã§ã€curlã‚„Postmanãªã©ã®HTTPã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰å®Ÿè¡Œã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

å®Ÿè¡Œã™ã‚‹APIã®ãƒ‘ã‚¹ã¯ã€tRPCã®ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£åã¨åŒã˜ã§ã™ã€‚ä¾‹ãˆã°`hello`ã¨ã„ã†ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚’å®Ÿè¡Œã™ã‚‹ã«ã¯ã€ï¼ˆãƒ«ãƒ¼ã‚¿ãƒ¼ã‚’`/api/trpc`ã«ãƒã‚¦ãƒ³ãƒˆã—ã¦ã„ã‚‹å ´åˆã¯ï¼‰`/api/trpc/hello`ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’é€ã‚Œã°ã‚ˆã„ã§ã™ã€‚

HTTPãƒ¡ã‚½ãƒƒãƒ‰ã¨ãƒ‡ãƒ¼ã‚¿ã®é€ä¿¡æ–¹æ³•ã¯ã€æ¬¡ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«æ›¸ã‹ã‚Œã¦ã„ã¾ã™ã€‚

https://trpc.io/docs/rpc

| HTTP Method | Mapping         | Notes                                                                                                  |
| ----------- | --------------- | ------------------------------------------------------------------------------------------------------ |
| GET         | .query()        | Input JSON-stringified in query param. e.g. myQuery?input=${encodeURIComponent(JSON.stringify(input))} |
| POST        | .mutation()     | Input as POST body.                                                                                    |
| n/a         | .subscription() | Subscriptions are not supported in HTTP transport                                                      |

queryã®å ´åˆã¯GETã§APIã‚’å®Ÿè¡Œã—ã€inputã¯ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã—ã¦ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦é€ä¿¡ã—ã¾ã™ã€‚POSTã®å ´åˆã¯ã€æ™®é€šã®HTTP APIã¨åŒã˜ã‚ˆã†ã«ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒœãƒ‡ã‚£ã§ãƒ‡ãƒ¼ã‚¿ã‚’é€ä¿¡ã—ã¾ã™ã€‚

queryã®ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰å‡¦ç†ãŒå°‘ã—é¢å€’ãªã®ã§ã€Postmanã®å ´åˆã¯æ¬¡ã®ã‚³ãƒ¼ãƒ‰ã‚’Pre-request Scriptã«ç™»éŒ²ã™ã‚‹ã¨ä¾¿åˆ©ã§ã™ã€‚

```js
if(pm.request.method === 'GET' && pm.request.body.raw) {
  const input = encodeURIComponent(pm.request.body.raw);
  pm.request.addQueryParams(`input=${input}`);
  pm.request.update({ body: undefined })
}
```

## å‚è€ƒ

- https://github.com/trpc/trpc/issues/2480#issuecomment-1221237481
